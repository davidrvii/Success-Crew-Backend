generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model attendance {
  attendance_id     Int        @id @default(autoincrement())
  user_id           Int
  attendance_status String
  attendance_in     DateTime?
  attendance_out    DateTime?
  attendance_date   DateTime

  leaves            leaves[]
  overtimes         overtimes[]

  created_at        DateTime   @default(now())
  updated_at        DateTime   @default(now())

  users             users      @relation(fields: [user_id], references: [user_id])
}

model attendance_status {
  attendance_status_id   Int      @id(map: "employee_attendance_pk") @default(autoincrement())
  attendance_status_name String   @db.VarChar
  create_at              DateTime @default(now()) @db.Timestamp(6)
  update_at              DateTime @default(now()) @db.Timestamp(6)
}

model employee_status {
  employee_status_id   Int      @id(map: "employee_status_pk") @default(autoincrement())
  employee_status_name String   @db.VarChar
  create_at            DateTime @default(now()) @db.Timestamp(6)
  update_at            DateTime @default(now()) @db.Timestamp(6)
}

model follow_up {
  follow_up_id     Int      @id(map: "follow_up_pk") @default(autoincrement())
  visit_id         Int
  follow_up_status String   @db.VarChar
  follow_up_action String   @db.VarChar
  created_at       DateTime @default(now()) @db.Timestamptz(6)
  updated_at       DateTime @default(now()) @db.Timestamptz(6)
  visit            visit    @relation(fields: [visit_id], references: [visit_id], onDelete: NoAction, onUpdate: NoAction, map: "visit_follow_up_fk")
}

model leaves {
  leave_id       Int      @id @default(autoincrement())
  user_id        Int
  attendance_id  Int
  leave_title    String
  leave_desc     String
  leave_date     DateTime
  leave_status   String

  created_at     DateTime
  updated_at     DateTime

  users          users      @relation(fields: [user_id], references: [user_id])
  attendance     attendance @relation(fields: [attendance_id], references: [attendance_id])
}

model notifications {
  notification_id    Int      @id(map: "notifications_pk") @default(autoincrement())
  user_id            Int
  notification_title String   @db.VarChar
  notification_desc  String   @db.VarChar
  is_read            Boolean  @default(false)
  created_at         DateTime @default(now()) @db.Timestamptz(6)
  updated_at         DateTime @default(now()) @db.Timestamptz(6)
  users              users    @relation(fields: [user_id], references: [user_id], onDelete: NoAction, onUpdate: NoAction, map: "user_notification_fk")
}

model offices {
  office_id      Int      @id(map: "offices_pk") @default(autoincrement())
  office_name    String   @db.VarChar
  office_address String   @db.VarChar
  created_at     DateTime @default(now()) @db.Timestamptz(6)
  updated_at     DateTime @default(now()) @db.Timestamptz(6)
  users          users[]
}

model overtimes {
  overtime_id     Int      @id @default(autoincrement())
  user_id         Int
  attendance_id   Int
  overtime_desc   String
  overtime_date   DateTime?
  overtime_start  DateTime
  overtime_end    DateTime
  overtime_status String

  created_at      DateTime   @default(now())
  updated_at      DateTime   @default(now())

  users           users      @relation(fields: [user_id], references: [user_id])
  attendance      attendance @relation(fields: [attendance_id], references: [attendance_id])
}

model product_sold {
  product_sold_id       Int      @id(map: "product_sold_pk") @default(autoincrement())
  visit_id              Int
  product_sold_type     String   @db.VarChar
  product_sold_category String   @db.VarChar
  created_at            DateTime @default(now()) @db.Timestamptz(6)
  updated_at            DateTime @default(now()) @db.Timestamptz(6)
  visit                 visit    @relation(fields: [visit_id], references: [visit_id], onDelete: NoAction, onUpdate: NoAction, map: "visit_product_sold_fk")
}

model roles {
  role_id    Int      @id(map: "roles_pk") @default(autoincrement())
  role_name  String   @db.VarChar
  created_at DateTime @default(now()) @db.Timestamptz(6)
  updated_at DateTime @default(now()) @db.Timestamptz(6)
  users      users[]
}

model unit_serviced {
  unit_serviced_id       Int      @id(map: "unit_serviced_pk") @default(autoincrement())
  visit_id               Int
  unit_serviced_type     String   @db.VarChar
  unit_serviced_category String   @db.VarChar
  created_at             DateTime @default(now()) @db.Timestamptz(6)
  updated_at             DateTime @default(now()) @db.Timestamptz(6)
  visit                  visit    @relation(fields: [visit_id], references: [visit_id], onDelete: NoAction, onUpdate: NoAction, map: "visit_unit_serviced_fk")
}

model users {
  user_id       Int             @id(map: "users_pk") @default(autoincrement())
  office_id     Int
  role_id       Int
  user_name     String          @db.VarChar
  user_email    String          @unique(map: "user_email") @db.VarChar
  user_password String          @db.VarChar
  user_photo    Bytes?
  created_at    DateTime        @default(now()) @db.Timestamptz(6)
  updated_at    DateTime        @default(now()) @db.Timestamptz(6)
  attendance    attendance[]
  leaves        leaves[]
  notifications notifications[]
  overtimes     overtimes[]
  offices       offices         @relation(fields: [office_id], references: [office_id], onDelete: NoAction, onUpdate: NoAction, map: "office_user_fk")
  roles         roles           @relation(fields: [role_id], references: [role_id], onDelete: NoAction, onUpdate: NoAction, map: "role_user_fk")
  visit         visit[]
}

model visit {
  visit_id         Int             @id(map: "visit_pk") @default(autoincrement())
  visitor_id       Int
  user_id          Int
  visitor_interest String
  visitor_status   String          @db.VarChar
  created_at       DateTime        @default(now()) @db.Timestamptz(6)
  updated_at       DateTime        @default(now()) @db.Timestamptz(6)
  follow_up        follow_up[]
  product_sold     product_sold[]
  unit_serviced    unit_serviced[]
  users            users           @relation(fields: [user_id], references: [user_id], onDelete: NoAction, onUpdate: NoAction, map: "user_visit_fk")
  visitor          visitor         @relation(fields: [visitor_id], references: [visitor_id], onDelete: NoAction, onUpdate: NoAction, map: "visitor_visit_fk")
}

model visitor {
  visitor_id          Int      @id(map: "visitor_pk") @default(autoincrement())
  visitor_name        String?  @db.VarChar
  visitor_phone       String?  @db.VarChar
  visitor_information String?  @db.VarChar
  visitor_address     String?  @db.VarChar
  created_at          DateTime @default(now()) @db.Timestamptz(6)
  updated_at          DateTime @default(now()) @db.Timestamptz(6)
  visit               visit[]
}
